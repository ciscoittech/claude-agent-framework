# /ingest-best-practice Command

**Purpose**: Ingest new Anthropic best practice documents, extract principles, analyze gaps, and prepare for testing

**Usage**: `/ingest-best-practice <URL>`

**Example**: `/ingest-best-practice https://www.anthropic.com/engineering/writing-tools-for-agents`

---

## Workflow Overview

This command orchestrates a multi-stage workflow to integrate new best practices into the framework:

```
Stage 1: Document Analysis (Best Practice Analyzer)
    â†“
Stage 2: Gap Analysis (Framework Gap Analyzer)
    â†“
Stage 3: Report Generation
```

---

## Command Execution

When user invokes `/ingest-best-practice <URL>`:

### Stage 1: Extract Best Practices

Launch the **Best Practice Analyzer** agent:

```markdown
Load agent from: .claude-library/agents/specialized/best-practice-analyzer.md

Task: "Analyze the Anthropic best practice document at {URL}. Extract key principles, create structured context document with examples and framework application guidance. Save to .claude-library/contexts/anthropic-best-practices/"

Expected Output:
- Structured markdown document with 3-7 key principles
- Concrete examples and implementation guidance
- Framework application recommendations
- Success metrics and checklists
```

### Stage 2: Analyze Gaps

Launch the **Framework Gap Analyzer** agent:

```markdown
Load agent from: .claude-library/agents/specialized/framework-gap-analyzer.md

Task: "Analyze gaps between the best practice document just created and the current Claude Agent Framework. Compare principle-by-principle, identify alignments and gaps, prioritize improvements. Save analysis to .claude-library/experiments/{best-practice-name}/gap-analysis.md"

Expected Output:
- Comprehensive gap analysis report
- Principle-by-principle comparison
- Prioritized action plan
- Effort and impact estimates
- Simplicity impact assessment
```

### Stage 3: Generate Summary Report

Create user-facing summary:

```markdown
# Best Practice Ingestion Report

**Source**: {URL}
**Date**: {timestamp}
**Best Practice Name**: {name}

## ğŸ“„ Documents Created

1. Context Document: `.claude-library/contexts/anthropic-best-practices/{name}.md`
   - {N} principles extracted
   - Framework application guidance included

2. Gap Analysis: `.claude-library/experiments/{name}/gap-analysis.md`
   - {N} gaps identified
   - {N} quick wins available
   - Overall alignment: {X}%

## ğŸ¯ Top Priority Actions

1. **{Action Name}** - Effort: {X}h, Impact: {Y}%
   - Files: {list}
   - Change: {brief description}

2. **{Action Name}** - Effort: {X}h, Impact: {Y}%
   - Files: {list}
   - Change: {brief description}

3. **{Action Name}** - Effort: {X}h, Impact: {Y}%
   - Files: {list}
   - Change: {brief description}

## âš¡ Quick Wins

- {Quick win description} - {X}h, {Y}% impact

## ğŸš« Simplicity Conflicts

{List any conflicts with simplicity principle, or "None detected"}

## ğŸ“Š Next Steps

1. Review gap analysis: `.claude-library/experiments/{name}/gap-analysis.md`
2. Select priority actions to implement
3. Create experimental implementations
4. Run validation tests: `pytest test_best_practice_{name}.py`
5. Compare before/after metrics
6. Integrate successful improvements

## ğŸ§ª Testing Recommendation

Run: `/validate-framework {name}` to test experimental improvements

---

Generated by /ingest-best-practice command
```

---

## Implementation Notes

### Sequential Execution
The stages must run sequentially (not parallel) because:
- Stage 2 depends on Stage 1's output (context document)
- Summary depends on both stages completing

### Error Handling

**If WebFetch fails**:
- Report error to user
- Suggest checking URL or network connection
- Offer to proceed with manually provided document

**If analysis fails**:
- Report which stage failed
- Provide partial results if available
- Suggest manual review

**If simplicity conflicts detected**:
- Highlight in summary report
- Recommend careful review before proceeding
- Suggest adaptations to maintain simplicity

### Output Locations

All outputs follow this structure:
```
.claude-library/
â”œâ”€â”€ contexts/
â”‚   â””â”€â”€ anthropic-best-practices/
â”‚       â””â”€â”€ {best-practice-name}.md          # Stage 1 output
â””â”€â”€ experiments/
    â””â”€â”€ {best-practice-name}/
        â”œâ”€â”€ gap-analysis.md                   # Stage 2 output
        â”œâ”€â”€ experimental-changes/             # Future: Stage 4
        â””â”€â”€ test-results/                     # Future: Stage 5
```

---

## Success Criteria

The command succeeds when:
- âœ… Best practice context document created
- âœ… Gap analysis report generated
- âœ… Summary report displayed to user
- âœ… Clear next steps provided
- âœ… No critical errors encountered

---

## Example Output

```
ğŸ”„ Ingesting best practice from Anthropic...

ğŸ“¥ Stage 1: Extracting best practices
   â””â”€ Launching Best Practice Analyzer...
   â””â”€ âœ… Extracted 5 principles
   â””â”€ ğŸ“„ Saved to contexts/anthropic-best-practices/writing-tools-for-agents.md

ğŸ” Stage 2: Analyzing framework gaps
   â””â”€ Launching Framework Gap Analyzer...
   â””â”€ âœ… Analyzed 5 principles
   â””â”€ âš ï¸  Identified 2 high-priority gaps
   â””â”€ ğŸ“„ Saved to experiments/writing-tools-for-agents/gap-analysis.md

ğŸ“Š Summary Report
==================

Top Priority Actions:
1. Add tool namespacing to REGISTRY.json - 2h, 30% error reduction
2. Rewrite agent tool descriptions - 8h, 20% token reduction

Quick Wins:
- Update output format guidelines - 1h, 15% context quality improvement

Next Steps:
1. Review gap analysis: experiments/writing-tools-for-agents/gap-analysis.md
2. Implement priority actions
3. Run: /validate-framework writing-tools-for-agents

âœ… Best practice ingestion complete!
```

---

## Related Commands

- `/validate-framework {name}` - Test improvements from this best practice
- `/feature` - Implement priority actions as features

---

## Maintenance

When updating this command:
- Keep sequential stages (don't parallelize due to dependencies)
- Maintain clear progress indicators
- Ensure all outputs are saved to correct locations
- Update success criteria if workflow changes

---

*Command Version 1.0*
*Part of Claude Agent Framework - Best Practices Integration System*
